<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8" />
  <title>Simulovan√Ω podvodn√Ω hovor ‚Äì Banka + Pol√≠cia</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <style>
    :root {
      --bg: #020617;
      --fg: #e5e7eb;
      --accent: #22c55e;
      --danger: #ef4444;
      --muted: #94a3b8;
      --border: #1f2937;
      --android-green: #00c853;
      --android-blue: #1977b4;
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, #0b1120 0, #020617 55%, #000 100%);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: var(--fg);
    }

    .phone-wrapper {
      position: relative;
    }

    .vignette {
      position: absolute;
      inset: -40px;
      pointer-events: none;
      background: radial-gradient(circle at center, rgba(0,0,0,0) 40%, rgba(0,0,0,0.8) 100%);
      z-index: 1;
    }

    .phone-frame {
      width: min(380px, 100vw - 24px);
      height: min(760px, 100vh - 24px);
      background: #020617;
      border-radius: 32px;
      padding: 12px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.7);
      border: 1px solid rgba(148,163,184,0.2);
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
      z-index: 2;
    }

    .phone-notch {
      width: 80px;
      height: 10px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
    }

    .phone-inner {
      flex: 1;
      border-radius: 26px;
      background: radial-gradient(circle at top, #0f172a 0, #020617 45%, #020617 100%);
      border: 1px solid rgba(148,163,184,0.2);
      padding: 14px 12px 12px;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .status-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 8px;
    }

    .status-right {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .signal-dots {
      display: flex;
      gap: 2px;
    }

    .signal-dot {
      width: 4px;
      height: 4px;
      border-radius: 999px;
      background: var(--muted);
    }

    .signal-dot.active {
      background: #22c55e;
    }

    .battery {
      width: 18px;
      height: 9px;
      border-radius: 3px;
      border: 1px solid var(--muted);
      position: relative;
      overflow: hidden;
    }
    .battery::after {
      content: "";
      position: absolute;
      inset: 1px 1px 1px 5px;
      background: #22c55e;
    }

    .screen {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      justify-content: center;
      gap: 14px;
      padding: 12px;
    }

    .label-small {
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--muted);
    }

    .caller-avatar {
      width: 86px;
      height: 86px;
      border-radius: 999px;
      background: radial-gradient(circle at top, #22c55e 0, #16a34a 40%, #15803d 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 34px;
      color: white;
      box-shadow: 0 12px 30px rgba(34,197,94,0.5);
      position: relative;
    }

    .caller-avatar.police {
      background: radial-gradient(circle at top, #f97316 0, #ea580c 40%, #c2410c 100%);
      box-shadow: 0 12px 30px rgba(248,113,113,0.5);
    }

    .pulse-ring {
      position: absolute;
      inset: -10px;
      border-radius: inherit;
      border: 1px solid rgba(34,197,94,0.5);
      opacity: 0.8;
      animation: pulse 1.5s ease-out infinite;
    }

    .caller-avatar.police .pulse-ring {
      border-color: rgba(248,113,113,0.6);
    }

    @keyframes pulse {
      0% { transform: scale(1); opacity: 0.8; }
      70% { transform: scale(1.12); opacity: 0; }
      100% { transform: scale(1.12); opacity: 0; }
    }

    .caller-name {
      font-size: 20px;
      font-weight: 600;
    }

    .caller-number {
      font-size: 13px;
      color: var(--muted);
    }

    .call-timer {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 14px;
      color: var(--muted);
    }

    .helper-text {
      font-size: 13px;
      color: var(--muted);
      max-width: 260px;
    }

    .helper-text b {
      color: #e5e7eb;
    }

    .call-controls {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-top: 18px;
    }

    .circle-btn {
      width: 68px;
      height: 68px;
      border-radius: 999px;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      color: white;
      cursor: pointer;
      box-shadow: 0 12px 24px rgba(0,0,0,0.5);
    }

    .circle-btn.green {
      background: radial-gradient(circle at top, var(--android-green) 0, #00b341 40%, #009b36 100%);
    }

    .circle-btn.red {
      background: radial-gradient(circle at top, #ef4444 0, #dc2626 40%, #b91c1c 100%);
    }

    .circle-label {
      margin-top: 4px;
      font-size: 11px;
      color: var(--muted);
    }

    .bottom-bar {
      margin-top: auto;
      font-size: 11px;
      color: var(--muted);
      text-align: center;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      border: 1px solid var(--border);
      margin-bottom: 4px;
      font-size: 11px;
    }

    .pill-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
    }

    .missed-label {
      color: #f97316;
      font-size: 13px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .primary-btn {
      margin-top: 10px;
      padding: 10px 16px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(to right, #22c55e, #16a34a);
      color: white;
      font-size: 14px;
      font-weight: 600;
      display: inline-flex;
      gap: 8px;
      align-items: center;
      cursor: pointer;
      box-shadow: 0 10px 20px rgba(22,163,74,0.5);
    }

    .primary-btn .icon {
      font-size: 18px;
    }

    .modal-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(15,23,42,0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
      z-index: 5;
    }

    .modal {
      width: 100%;
      max-width: 300px;
      background: #020617;
      border-radius: 18px;
      padding: 16px 14px 14px;
      border: 1px solid rgba(148,163,184,0.4);
      box-shadow: 0 18px 30px rgba(0,0,0,0.7);
      text-align: left;
      font-size: 13px;
    }

    .modal-title {
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .modal-text {
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 10px;
    }

    .modal-actions {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-top: 4px;
    }

    .btn-text {
      border: none;
      background: transparent;
      color: #38bdf8;
      font-size: 13px;
      cursor: pointer;
      padding: 6px 4px;
    }

    .btn-solid {
      border: none;
      border-radius: 999px;
      background: #22c55e;
      color: white;
      font-size: 13px;
      padding: 6px 12px;
      cursor: pointer;
    }

    .progress-wrapper {
      width: 100%;
      max-width: 260px;
      background: rgba(15,23,42,0.9);
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.4);
      overflow: hidden;
      height: 14px;
      margin-top: 4px;
    }

    .progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(to right, #22c55e, #4ade80);
      transition: width 0.15s linear;
    }

    .progress-label {
      font-size: 12px;
      color: var(--muted);
      margin-top: 6px;
    }

    .final-tips {
      font-size: 13px;
      color: var(--muted);
      text-align: left;
      max-width: 280px;
    }

    .final-tips ul {
      padding-left: 18px;
      margin: 6px 0;
    }

    .final-tips li {
      margin-bottom: 4px;
    }

  </style>
</head>
<body>
  <div class="phone-wrapper">
    <div class="phone-frame">
      <div class="phone-notch"></div>
      <div class="phone-inner">
        <div class="status-bar">
          <div>9:41</div>
          <div class="status-right">
            <div class="signal-dots">
              <div class="signal-dot active"></div>
              <div class="signal-dot active"></div>
              <div class="signal-dot active"></div>
              <div class="signal-dot active"></div>
              <div class="signal-dot active"></div>
            </div>
            <div class="battery"></div>
          </div>
        </div>

        <div id="screen" class="screen">
          <div class="label-small">Naƒç√≠tava sa simul√°cia hovoru...</div>
        </div>

        <!-- Audio prvky -->
        <audio id="ringtone" src="ring.mp3" preload="auto"></audio>
        <audio id="endTone" src="end.mp3" preload="auto"></audio>
        <audio id="callBank" src="bank.mp3" preload="auto"></audio>
        <audio id="callPolice1" src="police1.m4a" preload="auto"></audio>
        <audio id="callPolice2" src="police2.m4a" preload="auto"></audio>
      </div>

      <div id="modalHost"></div>
    </div>
    <div class="vignette"></div>
  </div>

  <script>
    const screenEl = document.getElementById("screen");
    const modalHost = document.getElementById("modalHost");

    const ringtone = document.getElementById("ringtone");
    const endTone = document.getElementById("endTone");
    const callBank = document.getElementById("callBank");
    const callPolice1 = document.getElementById("callPolice1");
    const callPolice2 = document.getElementById("callPolice2");

    ringtone.loop = true;

    let state = "idle";
    let callTimerInterval = null;
    let callSeconds = 0;
    let progressInterval = null;

    function vibratePattern(pattern) {
      if ("vibrate" in navigator) {
        navigator.vibrate(pattern);
      }
    }

    function stopVibration() {
      if ("vibrate" in navigator) {
        navigator.vibrate(0);
      }
    }

    function formatTime(seconds) {
      const m = String(Math.floor(seconds / 60)).padStart(2, "0");
      const s = String(seconds % 60).padStart(2, "0");
      return `${m}:${s}`;
    }

    function clearTimers() {
      if (callTimerInterval) {
        clearInterval(callTimerInterval);
        callTimerInterval = null;
      }
      if (progressInterval) {
        clearInterval(progressInterval);
        progressInterval = null;
      }
    }

    function renderIncomingCall(opts) {
      const { label, name, number, isPolice } = opts;
      screenEl.innerHTML = `
        <div class="label-small">${label}</div>
        <div class="caller-avatar ${isPolice ? "police" : ""}">
          <div class="pulse-ring"></div>
          <span>${isPolice ? "üëÆ" : "‚Ç¨"}</span>
        </div>
        <div class="caller-name">${name}</div>
        <div class="caller-number">${number}</div>


        <div class="call-controls">
          <div style="display:flex; flex-direction:column; align-items:center;">
            <button class="circle-btn red" id="btnDecline">‚úï</button>
            <div class="circle-label">Odmietnu≈•</div>
          </div>
          <div style="display:flex; flex-direction:column; align-items:center;">
            <button class="circle-btn green" id="btnAnswer">üìû</button>
            <div class="circle-label">Zdvihn√∫≈•</div>
          </div>
        </div>

        <div class="bottom-bar">
          
          <div>Sk√∫ste reagova≈•, akoby to bol naozaj v√°≈° hovor.</div>
        </div>
      `;

      document.getElementById("btnAnswer").addEventListener("click", () => {
        if (state === "incoming_bank") startBankCall();
        else if (state === "incoming_police") startPoliceCallPhase1();
      });

      document.getElementById("btnDecline").addEventListener("click", () => {
        stopVibration();
        ringtone.pause();
        ringtone.currentTime = 0;
        renderMissedScreen();
      });
    }

    function renderInCallScreen(opts) {
      const { name, isPolice } = opts;
      screenEl.innerHTML = `
        <div class="label-small">Prebiehaj√∫ci hovor</div>
        <div class="caller-avatar ${isPolice ? "police" : ""}">
          <span>${isPolice ? "üëÆ" : "‚Ç¨"}</span>
        </div>
        <div class="caller-name">${name}</div>
        <div class="call-timer" id="callTimer">00:00</div>
        <div class="helper-text">
          Poƒç√∫vaj, ak√© argumenty volaj√∫ci pou≈æ√≠va. 
        </div>

        <div class="call-controls">
          <div style="display:flex; flex-direction:column; align-items:center;">
            <button class="circle-btn red" id="btnEndCall">‚èπ</button>
            <div class="circle-label">Ukonƒçi≈•</div>
          </div>
        </div>

        <div class="bottom-bar">

          <div>M√¥≈æe≈° hovor kedykoƒævek ukonƒçi≈•.</div>
        </div>
      `;

      const timerEl = document.getElementById("callTimer");
      callSeconds = 0;
      callTimerInterval = setInterval(() => {
        callSeconds++;
        timerEl.textContent = formatTime(callSeconds);
      }, 1000);

document.getElementById("btnEndCall").addEventListener("click", () => {
  if (state === "in_call_bank") {
    userEndedBankCall();
  } else if (state === "in_call_police_phase1") {
    userEndedPolicePhase1();
  } else if (state === "in_call_police_phase2") {
    userEndedPolicePhase2(); // ak ju pou≈æ√≠va≈°, inak m√¥≈æe by≈• len userEndedPolicePhase1
  }
});
    }
function userEndedPolicePhase1() {
  clearTimers();
  try { callPolice1.pause(); } catch (e) {}

  try {
    endTone.currentTime = 0;
    endTone.play().catch(() => {});
  } catch (err) {}

  renderMissedScreen();
}
    function renderMissedScreen() {
      screenEl.innerHTML = `
        <div class="missed-label">Simulovan√Ω hovor ukonƒçen√Ω</div>
        <div class="caller-avatar">
          <span>üìµ</span>
        </div>
        <div class="caller-name">Hovor ste ukonƒçili</div>
        <div class="helper-text">
          V re√°lnom ≈æivote je <b>polo≈æi≈•</b> alebo <b>nezdvihn√∫≈•</b> ƒçasto najbezpeƒçnej≈°ie rie≈°enie.
        </div>
        <button class="primary-btn" id="btnAgain">
          <span class="icon">üîÅ</span>
          <span>Spusti≈• simul√°ciu znova</span>
        </button>
      `;

      document.getElementById("btnAgain").addEventListener("click", () => {
        clearTimers();
        stopVibration();
        startIncomingBankCall();
      });
    }

    function showDownloadModal() {
      modalHost.innerHTML = `
        <div class="modal-backdrop">
          <div class="modal">
            <div class="modal-title">ANIDESK aplik√°cia</div>
            <div class="modal-text">
              Policajt tvrd√≠, ≈æe pre kontrolu √∫ƒçtu potrebuje≈° nain≈°talova≈• ≈°peci√°lnu aplik√°ciu.
              Klikni na tlaƒçidlo stiahn√∫≈•‚Äú.
            </div>
            <div class="modal-actions">
              <button class="btn-text" id="btnCancelDownload">Zru≈°i≈•</button>
              <button class="btn-solid" id="btnStartDownload">Stiahnu≈• aplik√°ciu</button>
            </div>
          </div>
        </div>
      `;

      document.getElementById("btnCancelDownload").addEventListener("click", () => {
        modalHost.innerHTML = "";
        renderFinalTips(false);
      });

      document.getElementById("btnStartDownload").addEventListener("click", () => {
        modalHost.innerHTML = "";
        startDownloadSimulation();
      });
    }

    function startDownloadSimulation() {
      state = "downloading";
      clearTimers();
      stopVibration();

      screenEl.innerHTML = `
        <div class="label-small">In≈°tal√°cia aplik√°cie</div>
        <div class="caller-avatar police">
          <span>üì≤</span>
        </div>
        <div class="caller-name">‚ÄûANIDESK aplik√°cia‚Äú</div>
        <div class="helper-text">
          Po nain≈°talovan√≠ aplik√°cie sa ti zjav√≠ k√≥d.
        </div>
        <div class="progress-wrapper">
          <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="progress-label" id="progressLabel">In≈°talujem... 0%</div>

      `;

      const bar = document.getElementById("progressBar");
      const label = document.getElementById("progressLabel");
      let progress = 0;

      progressInterval = setInterval(() => {
        progress += 4;
        if (progress > 100) progress = 100;
        bar.style.width = progress + "%";
        label.textContent = `In≈°talujem... ${progress}%`;

        if (progress >= 100) {
          clearInterval(progressInterval);
          progressInterval = null;
          startPoliceIdPhase();
        }
      }, 250);
    }

    function startPoliceIdPhase() {
      state = "in_call_police_phase2";
      clearTimers();
      stopVibration();

      screenEl.innerHTML = `
        <div class="label-small">Aplik√°cia je nain≈°talovan√°</div>
        <div class="caller-avatar police">
          <span>üëÆ</span>
        </div>
        <div class="caller-name">Pol√≠cia SR</div>
        <div class="helper-text">
          Tvoje ID ƒç√≠slo je 123123. Rozhodni sa ƒçi mu ho nadiktuje≈° alebo nie.
        </div>

        <div class="call-controls">
          <div style="display:flex; flex-direction:column; align-items:center;">
            <button class="circle-btn green" id="btnGiveId">üîê</button>
            <div class="circle-label">Nadiktova≈• ID</div>
          </div>
          <div style="display:flex; flex-direction:column; align-items:center;">
            <button class="circle-btn red" id="btnRefuseId">‚úã</button>
            <div class="circle-label">Odmietnu≈•</div>
          </div>
        </div>

        <div class="bottom-bar">
          <div class="pill">
            <div class="pill-dot"></div>
            <span>Toto je kƒæ√∫ƒçov√Ω moment ‚Äì rozhoduje≈°, ƒçi "pol√≠cia" z√≠ska pr√≠stup.</span>
          </div>
        </div>
      `;

      try {
        callPolice2.currentTime = 0;
        callPolice2.play().catch(err => {
          console.error("Chyba pri prehr√°van√≠ police2 hovoru:", err);
        });
      } catch (err) {
        console.error("Police2 audio error:", err);
      }

      document.getElementById("btnGiveId").addEventListener("click", () => {
        showFinalAlert(true);
      });

      document.getElementById("btnRefuseId").addEventListener("click", () => {
        showFinalAlert(false);
      });
    }

    function showFinalAlert(gaveId) {
      const text = gaveId
        ? `T√Ωm, ≈æe si nadiktoval svoje ‚ÄûID‚Äú, ste podvodn√≠kovi umo≈ænili pr√≠stup k svojmu zariadeniu a √∫ƒçtu. 
           V realite by tak mohol vidie≈•, ƒço rob√≠≈° v mobile, a prebera≈• kontrolu nad internet bankingom.`
        : `Aj keƒè si aplik√°ciu nain≈°taloval, t√Ωm, ≈æe si odmietol nadiktova≈• ID/k√≥d, 
           si podvodn√≠kom zastavili pr√≠stup. Kƒæ√∫ƒçov√© je poveda≈• STOP v spr√°vny moment.`;

      modalHost.innerHTML = `
        <div class="modal-backdrop">
          <div class="modal">
            <div class="modal-title">${gaveId ? "Podvod sa podaril" : "Podvod ste zastavili"}</div>
            <div class="modal-text">
              ${text}
            </div>
            <ul style="padding-left:18px; margin:6px 0 10px; color:${getComputedStyle(document.body).getPropertyValue('--muted')}; font-size:13px;">
              <li>Podvodn√≠ci ƒçasto kombinuj√∫ viac krokov: hovor, aplik√°cia, ID/k√≥d.</li>
              <li>Ka≈æd√Ω ƒèal≈°√≠ krok im d√°va viac kontroly nad tvoj√≠m √∫ƒçtom.</li>
              <li>Pou≈æ√≠vaj pri hovoroch pravidlo STOP.</li>
            </ul>
            <div class="modal-actions">
              <button class="btn-solid" id="btnFinalOk">Rozumiem</button>
            </div>
          </div>
        </div>
      `;

      document.getElementById("btnFinalOk").addEventListener("click", () => {
        modalHost.innerHTML = "";
        renderFinalTips(true);
      });
    }

    function renderFinalTips(completedFlow) {
      state = "done";
      clearTimers();
      stopVibration();

      screenEl.innerHTML = `
        <div class="label-small">${completedFlow ? "Simul√°cia dokonƒçen√°" : "Simul√°cia ukonƒçen√°"}</div>
        <div class="caller-avatar">
          <span>üß†</span>
        </div>
        <div class="caller-name">ƒåo sme sa nauƒçili?</div>
        <div class="final-tips">
          <p><b>Podvodn√≠ci ƒçasto:</b></p>
          <ul>
            <li>volaj√∫ ako ‚Äûbanka‚Äú alebo ‚Äûpol√≠cia‚Äú,</li>
            <li>tvrdia, ≈æe mus√≠te kona≈• hneƒè,</li>
            <li>chc√∫ od v√°s k√≥dy, hesl√° alebo in≈°tal√°ciu aplik√°cie,</li>
            <li>postupuj√∫ po krokoch ‚Äì aby ste si nev≈°imli, kam to smeruje.</li>
            <li>chc√∫ aby sme o tom nikomu nehovorili.</li>
          </ul>
          <p><b>Zapam√§taj si STOP:</b></p>
          <ul>
            <li><b>Spomaƒæ</b> ‚Äì nereaguj hneƒè.</li>
            <li><b>Over</b> ‚Äì zavolaj na ofici√°lne ƒç√≠slo banky alebo pol√≠cie.</li>
            <li><b>Spoj sa</b> ‚Äì poraƒè sa s rodinou alebo zn√°mym.</li>
          </ul>
        </div>
        <button class="primary-btn" id="btnRestart">
          <span class="icon">üîÅ</span>
          <span>Spusti≈• simul√°ciu znova</span>
        </button>
      `;

      document.getElementById("btnRestart").addEventListener("click", () => {
        startIncomingBankCall();
      });
    }

    function playRingtone() {
      try {
        ringtone.currentTime = 0;
        ringtone.play().catch(err => {
          console.warn("Ringtone autoplay blocked:", err);
        });
      } catch (err) {
        console.warn("Ringtone error:", err);
      }
      vibratePattern([200, 150, 200, 150, 200]);
    }

    function startIncomingBankCall() {
      state = "incoming_bank";
      clearTimers();
      stopVibration();
      renderIncomingCall({
        label: "Prich√°dzaj√∫ci hovor",
        name: "Va≈°a banka",
        number: "+421 850 123 456",
        isPolice: false,
      });
      playRingtone();
    }

    function startBankCall() {
      state = "in_call_bank";
      stopVibration();
      ringtone.pause();
      ringtone.currentTime = 0;
      renderInCallScreen({ name: "Va≈°a banka", isPolice: false });

      try {
        callBank.currentTime = 0;
        callBank.play().catch(err => {
          console.error("Chyba pri prehr√°van√≠ bank hovoru:", err);
        });
      } catch (err) {
        console.error("Bank audio error:", err);
      }

      callBank.onended = () => {
        if (state === "in_call_bank") {
          finishBankCall();
        }
      };
    }
function userEndedBankCall() {
  clearTimers();
  try { callBank.pause(); } catch (e) {}

  try {
    endTone.currentTime = 0;
    endTone.play().catch(() => {});
  } catch (err) {}

  // rovnak√° obrazovka ako pri odmietnut√≠ / zlo≈æen√≠ hovoru
  renderMissedScreen();
}
    function finishBankCall() {
      clearTimers();
      callBank.pause();
      try {
        endTone.currentTime = 0;
        endTone.play().catch(() => {});
      } catch (err) {}
      screenEl.innerHTML = `
        <div class="label-small">Hovor ukonƒçen√Ω</div>
        <div class="caller-avatar">
          <span>‚Ç¨</span>
        </div>
        <div class="caller-name">Va≈°a banka</div>
        <div class="helper-text">
          ƒåakaj na hovor od policajta
        </div>
      `;
      setTimeout(() => {
        startIncomingPoliceCall();
      }, 3000);
    }

    function startIncomingPoliceCall() {
      state = "incoming_police";
      clearTimers();
      stopVibration();
      renderIncomingCall({
        label: "Prich√°dzaj√∫ci hovor",
        name: "Pol√≠cia SR",
        number: "No caller ID",
        isPolice: true,
      });
      playRingtone();
    }

    function startPoliceCallPhase1() {
      state = "in_call_police_phase1";
      stopVibration();
      ringtone.pause();
      ringtone.currentTime = 0;
      renderInCallScreen({ name: "Pol√≠cia SR", isPolice: true });

      try {
        callPolice1.currentTime = 0;
        callPolice1.play().catch(err => {
          console.error("Chyba pri prehr√°van√≠ police1 hovoru:", err);
        });
      } catch (err) {
        console.error("Police1 audio error:", err);
      }

      callPolice1.onended = () => {
        if (state === "in_call_police_phase1") {
          finishPoliceCallPhase1();
        }
      };
    }

function finishPoliceCallPhase1() {
  clearTimers();
  callPolice1.pause();
  try {
    endTone.currentTime = 0;
    endTone.play().catch(() => {});
  } catch (err) {}

  // ‚ùó ≈æiadna medzistr√°nka, rovno mod√°lne okno
  showDownloadModal();
}


    function finishPoliceCallPhase2() {
      // teoreticky by sme toto mohli pou≈æi≈•, ale teraz ideme cez buttons GiveId/RefuseId
      // nech√°vam pr√°zdne pre pr√≠padn√© bud√∫ce roz≈°√≠renie
    }

    window.addEventListener("load", () => {
      setTimeout(startIncomingBankCall, 200);
    });

    window.addEventListener("pagehide", () => {
      stopVibration();
      clearTimers();
      ringtone.pause();
      callBank.pause();
      callPolice1.pause();
      callPolice2.pause();
    });
  </script>
</body>
</html>








